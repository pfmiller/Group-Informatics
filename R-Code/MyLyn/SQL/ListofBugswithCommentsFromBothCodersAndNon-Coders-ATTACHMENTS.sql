select a.bug_id, a.author_id, b.author_id, count(*) as counter from(select bug_ID, author_id from research_comment_attachment where author_id in (select assigned_id from research_bug_fixer_people)group by bug_id) a INNER JOIN(select bug_ID, author_id from research_comment_attachment where author_id not in (select assigned_id from research_bug_fixer_people)group by bug_id) bUSING (bug_id)group by a.bug_id, a.author_id, b.author_idorder by bug_id 